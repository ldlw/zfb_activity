import{_ as a,o as e,c as s,Q as n}from"./chunks/framework.00e71275.js";const g=JSON.parse('{"title":"","description":"元气提醒","frontmatter":{"head":[["meta",{"name":"description","content":"元气提醒"}],["meta",{"name":"keywords","content":"公众号开发"}],["script",{"src":"https://vitepress-source.oss-cn-beijing.aliyuncs.com/statistics.js"}]]},"headers":[],"relativePath":"article/小轮子/元气提醒.md","filePath":"article/小轮子/元气提醒.md","lastUpdated":1667121428000}'),l={name:"article/小轮子/元气提醒.md"},p=n(`<h2 id="元气提醒" tabindex="-1">元气提醒 <a class="header-anchor" href="#元气提醒" aria-label="Permalink to &quot;元气提醒&quot;">​</a></h2><blockquote><p>利用微信订阅号的方式，给女朋友每天定时定时推送消息。</p><p>如果还没有女朋友的这个可以祝你一臂之力，早日脱单。</p></blockquote><p>源码地址：<a href="https://github.com/ldlw/Vitality-reminder" target="_blank" rel="noreferrer">元气提醒</a></p><h3 id="效果展示" tabindex="-1">效果展示 <a class="header-anchor" href="#效果展示" aria-label="Permalink to &quot;效果展示&quot;">​</a></h3><p><img src="https://img-blog.csdnimg.cn/94a6b22e8899464dbdfbaf11ba7ca675.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASmltbXnpm6rpm6o=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="最终的效果"></p><ul><li>每日定时发送元气提醒，（发送的时间可配置）</li><li>特殊时间也会发送特殊提醒，目前已有：发薪日、在一起纪念日、生日。之后会陆续增加</li><li>有变成能力的可以自己改动代码，实现更多的提醒</li></ul><h3 id="使用步骤" tabindex="-1">使用步骤 <a class="header-anchor" href="#使用步骤" aria-label="Permalink to &quot;使用步骤&quot;">​</a></h3><ul><li>将仓库克隆至本地</li><li><code>npm install</code>或<code>cnpm install</code>安装依赖配置文件</li><li>修改 config.js 的订阅号配置文件</li><li>修改 fnc.js 个人重要信息节点配置文件</li><li>创建订阅号测试号，配置群发消息模板</li><li>代码文件上传至个人服务器，先绑定一个订阅号，获取 accect_token</li><li>设置指定发送的人员，指定发送的时间</li><li>服务器挂上 app.js 脚本，配置全部完成！</li></ul><hr><h3 id="修改配置-config-js" tabindex="-1">修改配置 config.js <a class="header-anchor" href="#修改配置-config-js" aria-label="Permalink to &quot;修改配置 config.js&quot;">​</a></h3><p><img src="https://img-blog.csdnimg.cn/853858be1d8549de803ac820ceee0224.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASmltbXnpm6rpm6o=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="config.js配置信息"></p><ul><li>appid 和 AppSecret 都是申请微信公众号申请成功就可以获取的，但是这个群发的接口如果是以个人的名义申请的公众号是不能获取到这个接口权限的，这时候可以用一个测试开发公众号，上面有几乎所有的接口权限。<a href="https://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login" target="_blank" rel="noreferrer">微信公众平台接口测试帐号申请</a> 网址：<a href="https://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login%E3%80%82" target="_blank" rel="noreferrer">https://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login。</a></li><li>第三方天气接口我是在聚合数据平台申请的，是免费的接口，这里替换成各自的聚合数据接口的天气接口 key 即可<a href="https://www.juhe.cn/docs?bd_vid=7775114093417537769" target="_blank" rel="noreferrer">聚合数据</a> 地址：<a href="https://www.juhe.cn/docs?bd_vid=7775114093417537769" target="_blank" rel="noreferrer">https://www.juhe.cn/docs?bd_vid=7775114093417537769</a></li></ul><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3a3abed43d0b4af79d5fb0742b46e8a8~tplv-k3u1fbpfcp-watermark.image?" alt="image-20211011105146791"></p><ul><li>这里就有了这些基本的 id，直接复制即可。</li></ul><h3 id="修改-fnc-js" tabindex="-1">修改 fnc.js <a class="header-anchor" href="#修改-fnc-js" aria-label="Permalink to &quot;修改 fnc.js&quot;">​</a></h3><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/01f63c1aaeeb4c98bbfafcca8a52d463~tplv-k3u1fbpfcp-watermark.image?" alt="image-20211011105435010"></p><ul><li>修改 base 对象的 birthday、love、pay 字段替换为个人的即可了</li></ul><h3 id="创建微信公众号测试号-配置群发消息模板" tabindex="-1">创建微信公众号测试号，配置群发消息模板 <a class="header-anchor" href="#创建微信公众号测试号-配置群发消息模板" aria-label="Permalink to &quot;创建微信公众号测试号，配置群发消息模板&quot;">​</a></h3><blockquote><p><a href="https://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login" target="_blank" rel="noreferrer">微信公众平台接口测试帐号申请</a> 网址：<a href="https://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login%E3%80%82" target="_blank" rel="noreferrer">https://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login。</a></p></blockquote><p><img src="https://img-blog.csdnimg.cn/6994ad19e0e149f686517817d00c82fb.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASmltbXnpm6rpm6o=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><ul><li><p>元气提醒</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">{{dateTime.DATA}}</span></span>
<span class="line"><span style="color:#e1e4e8;">今天是 我们相恋的第{{love.DATA}}天</span></span>
<span class="line"><span style="color:#e1e4e8;">距离上交工资还有{{pay.DATA}}天</span></span>
<span class="line"><span style="color:#e1e4e8;">距离你的生日还有{{birthday.DATA}}天</span></span>
<span class="line"><span style="color:#e1e4e8;">今日天气 {{weather.DATA}}</span></span>
<span class="line"><span style="color:#e1e4e8;">今日温度 {{temp.DATA}}度</span></span>
<span class="line"><span style="color:#e1e4e8;">空气湿度 {{humidity.DATA}}</span></span>
<span class="line"><span style="color:#e1e4e8;">风向 {{wind.DATA}}</span></span>
<span class="line"><span style="color:#e1e4e8;">每日一句</span></span>
<span class="line"><span style="color:#e1e4e8;">{{message.DATA}}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">{{dateTime.DATA}}</span></span>
<span class="line"><span style="color:#24292e;">今天是 我们相恋的第{{love.DATA}}天</span></span>
<span class="line"><span style="color:#24292e;">距离上交工资还有{{pay.DATA}}天</span></span>
<span class="line"><span style="color:#24292e;">距离你的生日还有{{birthday.DATA}}天</span></span>
<span class="line"><span style="color:#24292e;">今日天气 {{weather.DATA}}</span></span>
<span class="line"><span style="color:#24292e;">今日温度 {{temp.DATA}}度</span></span>
<span class="line"><span style="color:#24292e;">空气湿度 {{humidity.DATA}}</span></span>
<span class="line"><span style="color:#24292e;">风向 {{wind.DATA}}</span></span>
<span class="line"><span style="color:#24292e;">每日一句</span></span>
<span class="line"><span style="color:#24292e;">{{message.DATA}}</span></span></code></pre></div></li><li><p>工资模板</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">{{dateTime.DATA}}</span></span>
<span class="line"><span style="color:#e1e4e8;">亲爱的，今天要发工资了，咱们账户上又多了一笔！注意查收~！</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">{{dateTime.DATA}}</span></span>
<span class="line"><span style="color:#24292e;">亲爱的，今天要发工资了，咱们账户上又多了一笔！注意查收~！</span></span></code></pre></div></li><li><p>生日模板</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">{{dateTime.DATA}}</span></span>
<span class="line"><span style="color:#e1e4e8;">听说今天是你人生当中第 {{individual.DATA}} 个生日？</span></span>
<span class="line"><span style="color:#e1e4e8;">天呐， 我差点忘记！因为你永远18岁~。</span></span>
<span class="line"><span style="color:#e1e4e8;">尽管，日历告诉我：你又涨了一岁，但你还是那个天真可爱的小仙女，生日快乐!</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">{{dateTime.DATA}}</span></span>
<span class="line"><span style="color:#24292e;">听说今天是你人生当中第 {{individual.DATA}} 个生日？</span></span>
<span class="line"><span style="color:#24292e;">天呐， 我差点忘记！因为你永远18岁~。</span></span>
<span class="line"><span style="color:#24292e;">尽管，日历告诉我：你又涨了一岁，但你还是那个天真可爱的小仙女，生日快乐!</span></span></code></pre></div></li><li><p>纪念日模板</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">{{dateTime.DATA}}</span></span>
<span class="line"><span style="color:#e1e4e8;">今天是在一起{{anniversary.DATA}}周年纪念日。</span></span>
<span class="line"><span style="color:#e1e4e8;">经历了风风雨雨,最终依然走在一起,很幸运,很幸福!我们的小家庭要一直幸福下去。</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">{{dateTime.DATA}}</span></span>
<span class="line"><span style="color:#24292e;">今天是在一起{{anniversary.DATA}}周年纪念日。</span></span>
<span class="line"><span style="color:#24292e;">经历了风风雨雨,最终依然走在一起,很幸运,很幸福!我们的小家庭要一直幸福下去。</span></span></code></pre></div></li></ul><p>这里的模板 id 就是分别对应的 config.js 的那四个模板 id</p><h3 id="获取公众号的-accect-token-的权限" tabindex="-1">获取公众号的 accect_token 的权限 <a class="header-anchor" href="#获取公众号的-accect-token-的权限" aria-label="Permalink to &quot;获取公众号的 accect_token 的权限&quot;">​</a></h3><blockquote><p>accect_token 是获取我们访问公众号接口的一个必填字段，需要先获取。获取这个需要有 url，所以需要准备一台个人的云服务器</p></blockquote><ul><li>将整个项目放到云服务器上</li><li>进入这个项目的目录</li><li>检查 config.js 文件中的 token 字段的值是不是和公众号接口配置中的值是一样的，需要时一致的。</li><li>用 node 运行一下 connect.js 脚本</li><li>提交一下接口配置信息的认证。等待页面提示成功</li><li>取消 node 的 connect.js 脚本</li></ul><p>此处我省略了一些内容，connect.js 监听的是 8080,但是接口配置只能是 80 端口或者 443 端口，所以基于这个需要做个接口的转发，利用宝塔面板可以很容易的实现接口的反向代理。</p><h3 id="设置指定发送的人员" tabindex="-1">设置指定发送的人员 <a class="header-anchor" href="#设置指定发送的人员" aria-label="Permalink to &quot;设置指定发送的人员&quot;">​</a></h3><p>进入 api.js,修改两个 template 对象的 touser 字段</p><p><img src="https://img-blog.csdnimg.cn/6095e2807d7741dfb3fced2e5845e12c.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASmltbXnpm6rpm6o=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><ul><li>这里没有写进配置文件是考虑到可能有要发给不同的人的需求？</li></ul><p>进入 app.js,修改 CromJob 构造函数的第一个参数来设置每日发送时间。</p><p><img src="https://img-blog.csdnimg.cn/08f716dee601488689d3841b44196a5d.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASmltbXnpm6rpm6o=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="修改定时发送时间"></p><h3 id="利用-pm2-运行-app-js-脚本" tabindex="-1">利用 pm2 运行 app.js 脚本 <a class="header-anchor" href="#利用-pm2-运行-app-js-脚本" aria-label="Permalink to &quot;利用 pm2 运行 app.js 脚本&quot;">​</a></h3><ul><li>先安装一下 pm2</li><li>进入项目目录</li><li>运行<code>pm2 start app.js</code></li></ul><h3 id="测试" tabindex="-1">测试 <a class="header-anchor" href="#测试" aria-label="Permalink to &quot;测试&quot;">​</a></h3><p>以上步骤如果都完成的了，可以手动在浏览器输入<code>url:8080/base</code>和<code>url:8080/base/important</code>,或者调整 app.js 的监听时间改成即将到的时间来测试</p><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p>本项目本质是写好一个可以访问公众号群发消息模板的接口，然后利用 CronJob 实现每日定时发送模板信息。</p><p>目前模板的内容有限，模板的内容会不断新增，有能力的小伙伴如果有兴趣也可以自己修改代码实现更多的功能。</p>`,39),i=[p];function t(o,c,r,d,h,m){return e(),s("div",null,i)}const u=a(l,[["render",t]]);export{g as __pageData,u as default};
